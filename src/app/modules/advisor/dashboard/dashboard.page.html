<ion-header [translucent]="true" class="ion-no-border">
  <ion-toolbar>
    <div class="header-logo">
      <img src="assets/images/logoTigo.png" alt="TigoConnect" class="header-logo-img">
    </div>
    <ion-buttons slot="end">
      <ion-button (click)="goToProfile()" class="profile-btn">
        <ion-icon name="person-circle-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="dashboard-content">
  <div class="welcome-section" *ngIf="currentUser$ | async as user">
    <div class="welcome-content">
      <h1>Hola<br><span>{{ user.full_name }}</span>!</h1>
      <p>Aqui esta tu panel de control</p>
    </div>
  </div>

  <div class="stats-section" *ngIf="stats$ | async as stats">
    <h3 class="section-title">Resumen</h3>
    <div class="stats-grid">
      <div class="stat-box">
        <div class="stat-icon">
          <ion-icon name="document-outline"></ion-icon>
        </div>
        <div class="stat-info">
          <p class="stat-value">{{ stats.totalPlanes }}</p>
          <p class="stat-label">Planes</p>
        </div>
      </div>

      <div class="stat-box">
        <div class="stat-icon pending">
          <ion-icon name="time-outline"></ion-icon>
        </div>
        <div class="stat-info">
          <p class="stat-value">{{ stats.contratacionesPendientes }}</p>
          <p class="stat-label">Pendientes</p>
        </div>
      </div>

      <div class="stat-box">
        <div class="stat-icon active">
          <ion-icon name="checkmark-circle-outline"></ion-icon>
        </div>
        <div class="stat-info">
          <p class="stat-value">{{ stats.contratacionesActivas }}</p>
          <p class="stat-label">Activas</p>
        </div>
      </div>
    </div>
  </div>

  <div class="plans-section">
    <div class="section-header">
      <h3 class="section-title">Tus Planes</h3>
      <ion-button fill="clear" size="small" (click)="goToCreatePlan()" class="create-plan-btn">
        <ion-icon name="add-circle-outline"></ion-icon>
      </ion-button>
    </div>

    <div class="plans-list">
      <div 
        *ngFor="let plan of (planes$ | async)" 
        class="plan-item-compact"
        (click)="goToEditPlan(plan.id)"
      >
        <div class="plan-info">
          <h4>{{ plan.nombre }}</h4>
          <p class="price">${{ plan.precio }}/mes</p>
          <div class="specs-mini">
            <span>{{ plan.datos_moviles }}</span>
            <span>{{ plan.minutos_voz }}</span>
          </div>
        </div>
        <ion-icon name="chevron-forward-outline"></ion-icon>
      </div>

      <div *ngIf="!(planes$ | async)?.length" class="no-plans">
        <ion-icon name="document-outline"></ion-icon>
        <p>Sin planes a√∫n</p>
      </div>
    </div>
  </div>

  <div class="floating-actions">
    <div class="fab-main" (click)="toggleFAB()" [class.open]="fabOpen">
      <ion-icon name="add"></ion-icon>
    </div>

    <div *ngIf="fabOpen" class="fab-menu">
      <button class="fab-item" (click)="goToCreatePlan(); toggleFAB()" title="Crear Plan">
        <ion-icon name="document-add-outline"></ion-icon>
        <span>Plan</span>
      </button>

      <button class="fab-item" (click)="goToPendingContracts(); toggleFAB()" title="Ver Solicitudes">
        <ion-icon name="checkbox-outline"></ion-icon>
        <span>Solicitudes</span>
      </button>

      <button class="fab-item" (click)="goToChatList(); toggleFAB()" title="Mensajes">
        <ion-icon name="chatbubbles-outline"></ion-icon>
        <span>Mensajes</span>
      </button>
    </div>

    <div class="fab-overlay" *ngIf="fabOpen" (click)="toggleFAB()"></div>
  </div>
</ion-content>
